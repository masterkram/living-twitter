from geopy.geocoders import Nominatim
import spacy
import json
import pandas as pd
import time
from tqdm import tqdm

data = json.loads(open("cities.json", "r").read())


class TweetData:
    tweet: str
    location: str
    coordinates: tuple
    replies: list[str]

    def __init__(self, tweet, location, coordinates, replies):
        self.tweet = tweet
        self.location = location
        self.coordinates = coordinates
        self.replies = replies


# Function to extract cities/places
def extract_locations(text):
    # Process the text with spaCy
    doc = nlp(text)

    # Extract location entities (GPE - Geo-Political Entity)
    locations = [ent.text for ent in doc.ents if ent.label_ == "GPE"]

    return locations


def convertTweets(tweets: list[dict]) -> list[TweetData]:
    myResult = []
    for tweet in tqdm(tweets):
        print(f"analyzing: {tweet}")
        locations: list[str] = extract_locations(tweet["parent"])
        myLocation: str = locations[0] if len(locations) > 0 else ""
        print(f"found location == {myLocation}")
        if tweet["parent"] != None and tweet["replies"] != None and myLocation != "":
            coords = get_coordinates(myLocation)
            print(f"coords == {coords}")
            myTweetData = TweetData(
                tweet["parent"], myLocation, coords, tweet["replies"]
            )
            myResult.append(myTweetData)
            print("sleep because we used api")
            time.sleep(7)

    return myResult


nlp = spacy.load("en_core_web_sm")

# Initialize geocoder
geolocator = Nominatim(user_agent="cityLocator")


# Function to get coordinates from location name
def get_coordinates(location_name) -> tuple:
    try:
        location = geolocator.geocode(location_name)
        if location:
            return (location.latitude, location.longitude)
        else:
            return (None, None)
    except Exception as e:
        print(f"Error: {e}")
        return (None, None)


myTweetData = convertTweets(data)

ICON_URL = "data:image/png;base64,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"

icon_data = {
    # Icon from Wikimedia, used the Creative Commons Attribution-Share Alike 3.0
    # Unported, 2.5 Generic, 2.0 Generic and 1.0 Generic licenses
    "url": ICON_URL,
    "width": 242,
    "height": 242,
    "anchorY": 242,
}


def tweetdata_to_dataframe(tweets):
    data = {
        "tweet": [tweet.tweet for tweet in tweets],
        "place": [tweet.location for tweet in tweets],
        "lat": [tweet.coordinates[0] for tweet in tweets],
        "lon": [tweet.coordinates[1] for tweet in tweets],
        "icon_data": [icon_data for _ in range(len(tweets))],
    }
    return pd.DataFrame(data)


# Convert tweets data to DataFrame
tweet_df = tweetdata_to_dataframe(myTweetData)

tweet_df.to_csv("tweetdf.csv")
